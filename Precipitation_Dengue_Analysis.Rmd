---
title: "Thailand Precipitation and Dengue Analysis"
output: pdf_document
date: "2023-05-12"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Data Upload
```{r}
library(readxl)
Precipitation <- read_excel("ClimateData_2006_2020.xlsx", sheet = "era5_tp_2006_2020_thailand_monm")
Precipitation

Dengue_2006 <- as.data.frame(read_excel("dengue_data.xlsx", sheet = "2006"))
Dengue_2007 <- as.data.frame(read_excel("dengue_data.xlsx", sheet = "2007"))
Dengue_2008 <- as.data.frame(read_excel("dengue_data.xlsx", sheet = "2008"))
Dengue_2009 <- as.data.frame(read_excel("dengue_data.xlsx", sheet = "2009"))
Dengue_2010 <- as.data.frame(read_excel("dengue_data.xlsx", sheet = "2010"))
Dengue_2011 <- as.data.frame(read_excel("dengue_data.xlsx", sheet = "2011"))
Dengue_2012 <- as.data.frame(read_excel("dengue_data.xlsx", sheet = "2012"))
Dengue_2013 <- as.data.frame(read_excel("dengue_data.xlsx", sheet = "2013"))
Dengue_2014 <- as.data.frame(read_excel("dengue_data.xlsx", sheet = "2014"))
Dengue_2015 <- as.data.frame(read_excel("dengue_data.xlsx", sheet = "2015"))
Dengue_2016 <- as.data.frame(read_excel("dengue_data.xlsx", sheet = "2016"))
Dengue_2017 <- as.data.frame(read_excel("dengue_data.xlsx", sheet = "2017"))
Dengue_2018 <- as.data.frame(read_excel("dengue_data.xlsx", sheet = "2018"))
Dengue_2019 <- as.data.frame(read_excel("dengue_data.xlsx", sheet = "2019"))
Dengue_2020 <- as.data.frame(read_excel("dengue_data.xlsx", sheet = "2020"))

Dengue = list(Dengue_2006, Dengue_2007, Dengue_2008, Dengue_2009, Dengue_2010, Dengue_2011, Dengue_2012, Dengue_2013, Dengue_2014, Dengue_2015, Dengue_2016, Dengue_2017, Dengue_2018, Dengue_2019, Dengue_2020)
```

#Data Copies for safety reasons 

```{r}
Dengue_2006c = Dengue_2006
Dengue_2007c = Dengue_2007
Dengue_2008c = Dengue_2008
Dengue_2009c = Dengue_2009
Dengue_2010c = Dengue_2010
Dengue_2011c = Dengue_2011
Dengue_2012c = Dengue_2012
Dengue_2013c = Dengue_2013
Dengue_2014c = Dengue_2014
Dengue_2015c = Dengue_2015
Dengue_2016c = Dengue_2016
Dengue_2017c = Dengue_2017
Dengue_2018c = Dengue_2018
Dengue_2019c = Dengue_2019
Dengue_2020c = Dengue_2020
```

#Data Cleaning

## list of province names
```{r}
province_names = c("Bangkok", "Samut Prakan", "Nonthaburi", "Pathum Thani", "Phra Nakhon Si Ayutthaya", "Ang Thong" ,               "Lop Buri",                 "Sing Buri",           "Chai Nat",                 "Saraburi" ,                "Chon Buri" ,               "Rayong"  ,                "Chanthaburi"   ,           "Trat"  ,                   "Chachoengsao"  ,           "Prachin Buri" ,           "Nakhon Nayok",             "Sa Kaeo" ,                 "Nakhon Ratchasima",        "Buri Ram" ,               "Surin"      ,              "Si Sa Ket" ,               "Ubon Ratchathani"  ,       "Yasothon",                "Chaiyaphum"    ,           "Amnat Charoen",            "Bungkan",                  "Nong Bua Lam Phu",        "Khon Kaen"      ,          "Udon Thani"    ,           "Loei"    ,                 "Nong Khai"        ,       "Maha Sarakham"   ,         "Roi Et"         ,          "Kalasin"  ,                "Sakon Nakhon"      ,      "Nakhon Phanom"    ,        "Mukdahan"        ,         "Chiang Mai",               "Lamphun"            ,     "Lampang"           ,       "Uttaradit"        ,        "Phrae"      ,              "Nan"                 ,    "Phayao"             ,      "Chiang Rai"        ,       "Mae Hong Son",             "Nakhon Sawan"         ,   "Uthai Thani"         ,     "Kamphaeng Phet"     ,      "Tak"          ,            "Sukhothai"             ,  "Phitsanulok"          ,    "Phichit"             ,     "Phetchabun"    ,           "Ratchaburi"             ,  "Kanchanaburi"      ,   "Suphan Buri"          ,    "Nakhon Pathom"  ,          "Samut Sakhon"            , "Samut Songkhram"        ,  "Phetchaburi"           ,   "Prachuap Khiri Khan",      "Nakhon Si Thammarat"     , "Krabi"            ,        "Phangnga"               ,  "Phuket"              ,     "Surat Thani"             , "Ranong"            ,       "Chumphon"                , "Songkhla"             ,    "Satun"                   , "Trang"              ,      "Phatthalung"              ,"Pattani"               ,   "Yala"                    , "Narathiwat")

province_names = as.data.frame(province_names)
province_names
```

## Align province names, delete useless rows and add province numbers for all data sets

### Dengue 2006

***Alignment of the province names***

```{r}
province_names[,1] %in% Dengue_2006[,1] #is the province name in the Dengue table?
which((province_names[,1] %in% Dengue_2006[,1]) == FALSE) #which provinces are NOT in the Dengue table?
province_names[which((province_names[,1] %in% Dengue_2006[,1]) == FALSE),1] #what are the names of these "missing" provinces

Dengue_2006[28,1] = province_names[5,1]

Dengue_2006
```

***Deletion of useless rows***
```{r}
Dengue_2006 = Dengue_2006[which((Dengue_2006[,1] %in% province_names[,1])), ]
rownames(Dengue_2006) = c(1:76)
Dengue_2006
```

***Addition of province numbers***
```{r}
Province_numbers = c()
```


```{r}
Dengue_2006c2 = cbind()

```

### Dengue 2007

***Alignment of the province names***
```{r}
province_names[,1] %in% Dengue_2007[,1] #is the province name in the Dengue table?
which((province_names[,1] %in% Dengue_2007[,1]) == FALSE) #which provinces are NOT in the Dengue table?
province_names[which((province_names[,1] %in% Dengue_2007[,1]) == FALSE),1] #what are the names of these "missing" provinces

Dengue_2007[28,1] = province_names[5,1] #set the correct name for the province
```
***Deletion of useless rows***
```{r}
Dengue_2007 = Dengue_2007[which((Dengue_2007[,1] %in% province_names[,1])), ]
rownames(Dengue_2007) = c(1:76)
Dengue_2007
```

### Dengue 2008

***Alignment of the province names***
```{r}
province_names[,1] %in% Dengue_2008[,1]
which((province_names[,1] %in% Dengue_2008[,1]) == FALSE) #which provinces are NOT in the Dengue table?
province_names[which((province_names[,1] %in% Dengue_2008[,1]) == FALSE),1] #what are the names of these "missing" provinces

Dengue_2008[6,1] = province_names[5,1] #set the correct name for the province
Dengue_2008[64,1] = province_names[35,1]
```

***Deletion of useless rows***
```{r}
Dengue_2008 = Dengue_2008[which((Dengue_2008[,1] %in% province_names[,1])), ]
rownames(Dengue_2008) = c(1:76)
Dengue_2008
```

### Dengue 2009

***Alignment of the province names***
```{r}
province_names[,1] %in% Dengue_2009[,1]
which((province_names[,1] %in% Dengue_2009[,1]) == FALSE) #which provinces are NOT in the Dengue table?
province_names[which((province_names[,1] %in% Dengue_2009[,1]) == FALSE),1] #what are the names of these "missing" provinces

Dengue_2009[6,1] = province_names[5,1] #set the correct name for the province
Dengue_2009[64,1] = province_names[35,1]
```

***Deletion of useless rows***
```{r}
Dengue_2006 = Dengue_2006[which((Dengue_2006[,1] %in% province_names[,1])), ]
rownames(Dengue_2006) = c(1:76)
Dengue_2006
```

### Dengue 2010

***Alignment of the province names***
```{r}
province_names[,1] %in% Dengue_2010[,1]
which((province_names[,1] %in% Dengue_2010[,1]) == FALSE) #which provinces are NOT in the Dengue table?
province_names[which((province_names[,1] %in% Dengue_2010[,1]) == FALSE),1] #what are the names of these "missing" provinces

Dengue_2010[6,1] = province_names1[5,1] #set the correct name for the province
```

***Deletion of useless rows***
```{r}
Dengue_2006 = Dengue_2006[which((Dengue_2006[,1] %in% province_names[,1])), ]
rownames(Dengue_2006) = c(1:76)
Dengue_2006
```

### Dengue 2011

***Alignment of the province names***
```{r}
province_names[,1] %in% Dengue_2011[,1] #is the province name in the Dengue table?
which((province_names[,1] %in% Dengue_2011[,1]) == FALSE) #which provinces are NOT in the Dengue table?
province_names[which((province_names[,1] %in% Dengue_2011[,1]) == FALSE),1] #what are the names of these "missing" provinces

Dengue_2011[6,1] = province_names[5,1] #set the correct name for the province
Dengue_2011[65,1] = province_names[35,1]
```

***Deletion of useless rows***
```{r}
Dengue_2006 = Dengue_2006[which((Dengue_2006[,1] %in% province_names[,1])), ]
rownames(Dengue_2006) = c(1:76)
Dengue_2006
```

### Dengue 2012

***Alignment of the province names***
```{r}
province_names[,1] %in% Dengue_2012[,1] #is the province name in the Dengue table?
which((province_names[,1] %in% Dengue_2012[,1]) == FALSE) #which provinces are NOT in the Dengue table?
province_names[which((province_names[,1] %in% Dengue_2012[,1]) == FALSE),1] #what are the names of these "missing" provinces

Dengue_2012[37,1] = province_names[5,1] #set the correct name for the province
Dengue_2012[14,1] = province_names[35,1]
```

***Deletion of useless rows***
```{r}
Dengue_2006 = Dengue_2006[which((Dengue_2006[,1] %in% province_names[,1])), ]
rownames(Dengue_2006) = c(1:76)
Dengue_2006
```

### Dengue 2013

***Alignment of the province names***
```{r}
province_names[,1] %in% Dengue_2013[,1] #is the province name in the Dengue table?
which((province_names[,1] %in% Dengue_2013[,1]) == FALSE) #which provinces are NOT in the Dengue table?
province_names[which((province_names[,1] %in% Dengue_2013[,1]) == FALSE),1] #what are the names of these "missing" provinces

Dengue_2013[37,1] = province_names[5,1]  #set the correct name for the province
Dengue_2013[14,1] = province_names[35,1]
```

***Deletion of useless rows***
```{r}
Dengue_2006 = Dengue_2006[which((Dengue_2006[,1] %in% province_names[,1])), ]
rownames(Dengue_2006) = c(1:76)
Dengue_2006
```

### Dengue 2014

***Alignment of the province names***
```{r}
province_names[,1] %in% Dengue_2014[,1] #is the province name in the Dengue table?
which((province_names[,1] %in% Dengue_2014[,1]) == FALSE) #which provinces are NOT in the Dengue table?
province_names[which((province_names[,1] %in% Dengue_2014[,1]) == FALSE),1] #what are the names of these "missing" provinces

Dengue_2014[37,1] = province_names[5,1] #set the correct name for the province
```

***Deletion of useless rows***
```{r}
Dengue_2006 = Dengue_2006[which((Dengue_2006[,1] %in% province_names[,1])), ]
rownames(Dengue_2006) = c(1:76)
Dengue_2006
```

### Dengue 2015

***Alignment of the province names***
```{r}
province_names[,1] %in% Dengue_2015[,1] #is the province name in the Dengue table?
which((province_names[,1] %in% Dengue_2015[,1]) == FALSE) #which provinces are NOT in the Dengue table?
province_names[which((province_names[,1] %in% Dengue_2015[,1]) == FALSE),1] #what are the names of these "missing" provinces

Dengue_2015[37,1] = province_names[5,1] #set the correct name for the province
```

***Deletion of useless rows***
```{r}
Dengue_2006 = Dengue_2006[which((Dengue_2006[,1] %in% province_names[,1])), ]
rownames(Dengue_2006) = c(1:76)
Dengue_2006
```

### Dengue 2016

***Alignment of the province names***
```{r}
province_names[,1] %in% Dengue_2016[,1] #is the province name in the Dengue table?
which((province_names[,1] %in% Dengue_2016[,1]) == FALSE) #which provinces are NOT in the Dengue table?
province_names[which((province_names[,1] %in% Dengue_2016[,1]) == FALSE),1] #what are the names of these "missing" provinces

Dengue_2016[37,1] = province_names[5,1] #set the correct name for the province
```

***Deletion of useless rows***
```{r}
Dengue_2006 = Dengue_2006[which((Dengue_2006[,1] %in% province_names[,1])), ]
rownames(Dengue_2006) = c(1:76)
Dengue_2006
```

### Dengue 2017

***Alignment of the province names***
```{r}
province_names[,1] %in% Dengue_2017[,1] #is the province name in the Dengue table?
which((province_names[,1] %in% Dengue_2017[,1]) == FALSE) #which provinces are NOT in the Dengue table?
province_names[which((province_names[,1] %in% Dengue_2017[,1]) == FALSE),1] #what are the names of these "missing" provinces

Dengue_2017[31,1] = province_names[5,1] #set the correct name for the province
```

***Deletion of useless rows***
```{r}
Dengue_2006 = Dengue_2006[which((Dengue_2006[,1] %in% province_names[,1])), ]
rownames(Dengue_2006) = c(1:76)
Dengue_2006
```

### Dengue 2018

***Alignment of the province names***
```{r}
province_names[,1] %in% Dengue_2018[,1] #is the province name in the Dengue table?
which((province_names[,1] %in% Dengue_2018[,1]) == FALSE) #which provinces are NOT in the Dengue table?
province_names[which((province_names[,1] %in% Dengue_2018[,1]) == FALSE),1] #what are the names of these "missing" provinces

Dengue_2018[31,1] = province_names[5,1] #set the correct name for the province
```

***Deletion of useless rows***
```{r}
Dengue_2006 = Dengue_2006[which((Dengue_2006[,1] %in% province_names[,1])), ]
rownames(Dengue_2006) = c(1:76)
Dengue_2006
```

### Dengue 2019

***Alignment of the province names***
```{r}
province_names[,1] %in% Dengue_2019[,1] #is the province name in the Dengue table?
which((province_names[,1] %in% Dengue_2019[,1]) == FALSE) #which provinces are NOT in the Dengue table?
province_names[which((province_names[,1] %in% Dengue_2019[,1]) == FALSE),1] #what are the names of these "missing" provinces

Dengue_2019[31,1] = province_names[5,1] #set the correct name for the province
```

***Deletion of useless rows***
```{r}
Dengue_2006 = Dengue_2006[which((Dengue_2006[,1] %in% province_names[,1])), ]
rownames(Dengue_2006) = c(1:76)
Dengue_2006
```

### Dengue 2020

***Alignment of the province names***
```{r}
province_names[,1] %in% Dengue_2020[,1] #is the province name in the Dengue table?
which((province_names[,1] %in% Dengue_2020[,1]) == FALSE) #which provinces are NOT in the Dengue table?
province_names[which((province_names[,1] %in% Dengue_2020[,1]) == FALSE),1] #what are the names of these "missing" provinces

Dengue_2020[31,1] = province_names[5,1] #set the correct name for the province
```

***Deletion of useless rows***
```{r}
Dengue_2006 = Dengue_2006[which((Dengue_2006[,1] %in% province_names[,1])), ]
rownames(Dengue_2006) = c(1:76)
Dengue_2006
```


