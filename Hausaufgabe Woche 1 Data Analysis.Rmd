# Install beforehand

```{r}
install.packages("readxl")
library(readxl)
```

# Thailand Climate Data:

```{r}
Thailand_daymin <- read_excel("Thailand.xlsx",sheet = "era5_t2m_daymin_annual_Thailand")
Thailand_daymin
```

```{r}
Thailand_daymax <- read_excel("Thailand.xlsx",sheet = "era5_t2m_daymax_annual_Thailand")
Thailand_daymax
```

```{r}
Thailand_tp <- read_excel("Thailand.xlsx",sheet = "era5_tp(mm)_annual_Thailand")
Thailand_tp
```

# Dengue Data

Extracted from Gideon:

```{r}
Gideon <- read_excel("Dengue_Data.xlsx",sheet = "Gideon")
Gideon
```

# Questions for Week 1

## Question 1 (Lenny)

Identify which sub-districts are having the highest and the lowest temperature and total precipitation.

***Precipitation***

Step 1: Sort Data Set "Total Precipitation" in 2022 from highest to lowest 
```{r}
Thailand_tp_sorted = Thailand_tp[order(Thailand_tp$`2022`, decreasing = TRUE), ]
Thailand_tp_sorted
```

Step Two: Give me the first six provinces with the highest precipitation and the lowest precipitation
```{r}
#sub districts with Highest Precipitation
Thailand_tp_highest = head(Thailand_tp_sorted)
Thailand_tp_highest_list = Thailand_tp_highest$ADM1_EN
Thailand_tp_highest_list
```

```{r}
#sub districts with Lowest Precipitation
Thailand_tp_lowest = tail(Thailand_tp_sorted) 
Thailand_tp_lowest_list = Thailand_tp_lowest$ADM1_EN
Thailand_tp_lowest_list
```

***Maximal Temperatur***

Step 1: Sort Data Set "Max Temperatur" in 2022 from highest to lowest 
```{r}
Thailand_daymax_sorted = Thailand_daymax[order(Thailand_daymax$`2022`, decreasing = TRUE), ]
Thailand_daymax_sorted
```

Step Two: Give me the first six provinces with the highest max temperatur and the lowest max temperatur
```{r}
#sub districts with Highest max Temperatur
Thailand_daymax_highest = head(Thailand_daymax_sorted)
Thailand_daymax_highest_list = Thailand_daymax_highest$ADM1_EN
Thailand_daymax_highest_list
```


```{r}
#sub districts with Lowest max temperatur
Thailand_daymax_lowest = tail(Thailand_daymax_sorted) 
Thailand_daymax_lowest_list = Thailand_daymax_lowest$ADM1_EN
Thailand_daymax_lowest_list
```



***Minimal Temperatur***

Step 1: Sort Data Set "Min Temperatur" in 2022 from highest to lowest 
```{r}
Thailand_daymin_sorted = Thailand_daymin[order(Thailand_daymin$`2022`, decreasing = TRUE), ]
Thailand_daymin_sorted
```

Step Two: Give me the first six provinces with the highest min temperatur and the lowest min temperatur
```{r}
#sub districts with Highest min Temperatur
Thailand_daymin_highest = head(Thailand_daymin_sorted)
Thailand_daymin_highest_list = Thailand_daymin_highest$ADM1_EN
Thailand_daymin_highest_list
```


```{r}
#sub districts with Lowest min temperatur
Thailand_daymin_lowest = tail(Thailand_daymin_sorted) 
Thailand_daymin_lowest_list = Thailand_daymin_lowest$ADM1_EN
Thailand_daymin_lowest_list
```

***Highest Maximum and Minimal Temperatur***

unique districts with the top highest min and max temperatures:
```{r}
Thailand_temp_highest = unique(c(Thailand_daymax_highest_list, Thailand_daymin_highest_list))
Thailand_temp_highest
```

***lowest Maximum and Minimal Temperatur***

unique districts with the lowest min and max temperatures
```{r}
Thailand_temp_lowest = unique(c(Thailand_daymax_lowest_list, Thailand_daymin_lowest_list))
Thailand_temp_lowest
```

Summary: 
Sub-districts highest temperature
```{r}
Thailand_temp_highest
```


sub-districts lowest temperature
```{r}
Thailand_temp_lowest
```


sub-districts highest total precipitation.
```{r}
Thailand_tp_highest_list
```


sub_districts lowest total precipitation
```{r}
Thailand_tp_lowest_list
```








## Question 2 (Fiona)

Where are these districts located (east, west, north, south or central of the country)?













## Question 3 (Lena)

Are the values of total precipitation realistic, please make some literature review and/or check with available historical weather data.

### Change in total percipitation over the years in the provinces

```{r}
plot(x = colnames(Thailand_tp[,5:19]), y = Thailand_tp[1,5:19], type = "b", pch = 19, xlab = "year", ylab = "total percipitation", main = "Bangkok (black), Trat (green) and Chiang Rai (red)", ylim = c(900,3500)); lines(colnames(Thailand_tp[,5:19]), Thailand_tp[46,5:19], type = "b", pch = 19, col = "red"); lines(colnames(Thailand_tp[,5:19]), Thailand_tp[14,5:19], type = "b", pch = 19, col = "green")
```

```{r}
#central 

plot(x = colnames(Thailand_tp[,5:19]), y = Thailand_tp[1,5:19], type = "b", pch = 19, col="red", ylim = c(900,3500), xlab = "year", ylab = "total percipitation", main = Thailand_tp[1,2])

plot(x = colnames(Thailand_tp[,5:19]), y = Thailand_tp[2,5:19], type = "b", pch = 19, col="red", ylim = c(900,3500), xlab = "year", ylab = "total percipitation", main = Thailand_tp[2,2])

plot(x = colnames(Thailand_tp[,5:19]), y = Thailand_tp[60,5:19], type = "b", pch = 19, col="red", ylim = c(900,3500), xlab = "year", ylab = "total percipitation", main = Thailand_tp[60,2])

#north

plot(x = colnames(Thailand_tp[,5:19]), y = Thailand_tp[46,5:19], type = "b", pch = 19, col="darkblue", ylim = c(900,3500), xlab = "year", ylab = "total percipitation", main = Thailand_tp[46,2])

plot(x = colnames(Thailand_tp[,5:19]), y = Thailand_tp[45,5:19], type = "b", pch = 19, col="darkblue", ylim = c(900,3500), xlab = "year", ylab = "total percipitation", main = Thailand_tp[45,2])

#south

plot(x = colnames(Thailand_tp[,5:19]), y = Thailand_tp[75,5:19], type = "b", pch = 19, col="green", ylim = c(900,3500), xlab = "year", ylab = "total percipitation", main = Thailand_tp[75,2])

plot(x = colnames(Thailand_tp[,5:19]), y = Thailand_tp[76,5:19], type = "b", pch = 19, col="green", ylim = c(900,3500), xlab = "year", ylab = "total percipitation", main = Thailand_tp[76,2])

plot(x = colnames(Thailand_tp[,5:19]), y = Thailand_tp[77,5:19], type = "b", pch = 19, col="green", ylim = c(900,3500), xlab = "year", ylab = "total percipitation", main = Thailand_tp[77,2])

#mid-tail

plot(x = colnames(Thailand_tp[,5:19]), y = Thailand_tp[69,5:19], type = "b", pch = 19, col="purple", ylim = c(900,3500), xlab = "year", ylab = "total percipitation", main = Thailand_tp[69,2])

plot(x = colnames(Thailand_tp[,5:19]), y = Thailand_tp[70,5:19], type = "b", pch = 19, col="purple",ylim = c(900,3500), xlab = "year", ylab = "total percipitation", main = Thailand_tp[70,2])

#west

plot(x = colnames(Thailand_tp[,5:19]), y = Thailand_tp[51,5:19], type = "b", pch = 19, col="turquoise", ylim = c(900,3500), xlab = "year", ylab = "total percipitation", main = Thailand_tp[51,2])

plot(x = colnames(Thailand_tp[,5:19]), y = Thailand_tp[57,5:19], type = "b", pch = 19, col="turquoise", ylim = c(900,3500), xlab = "year", ylab = "total percipitation", main = Thailand_tp[57,2])

#east

plot(x = colnames(Thailand_tp[,5:19]), y = Thailand_tp[22,5:19], type = "b", pch = 19, col="orange", ylim = c(900,3500), xlab = "year", ylab = "total percipitation", main = Thailand_tp[22,2])

plot(x = colnames(Thailand_tp[,5:19]), y = Thailand_tp[23,5:19], type = "b", pch = 19, col="orange", ylim = c(900,3500), xlab = "year", ylab = "total percipitation", main = Thailand_tp[23,2])

plot(x = colnames(Thailand_tp[,5:19]), y = Thailand_tp[26,5:19], type = "b", pch = 19, col="orange", ylim = c(900,3500), xlab = "year", ylab = "total percipitation", main = Thailand_tp[26,2])

```


```{r}
hist(Thailand_tp$"2008", breaks=15, main = colnames(Thailand_tp[,5]), xlab = "total percipitation")
hist(Thailand_tp$"2009", breaks=15, main = colnames(Thailand_tp[,6]), xlab = "total percipitation")
hist(Thailand_tp$"2010", breaks=15, main = colnames(Thailand_tp[,7]), xlab = "total percipitation")
hist(Thailand_tp$"2011", breaks=15, main = colnames(Thailand_tp[,8]), xlab = "total percipitation")
hist(Thailand_tp$"2012", breaks=15, main = colnames(Thailand_tp[,9]), xlab = "total percipitation")
hist(Thailand_tp$"2013", breaks=15, main = colnames(Thailand_tp[,10]), xlab = "total percipitation")
hist(Thailand_tp$"2014", breaks=15, main = colnames(Thailand_tp[,11]), xlab = "total percipitation")
hist(Thailand_tp$"2015", breaks=15, main = colnames(Thailand_tp[,12]), xlab = "total percipitation")
hist(Thailand_tp$"2016", breaks=15, main = colnames(Thailand_tp[,13]), xlab = "total percipitation")
hist(Thailand_tp$"2017", breaks=15, main = colnames(Thailand_tp[,14]), xlab = "total percipitation")
hist(Thailand_tp$"2018", breaks=15, main = colnames(Thailand_tp[,15]), xlab = "total percipitation")
hist(Thailand_tp$"2019", breaks=15, main = colnames(Thailand_tp[,16]), xlab = "total percipitation")
hist(Thailand_tp$"2020", breaks=15, main = colnames(Thailand_tp[,17]), xlab = "total percipitation")
hist(Thailand_tp$"2021", breaks=15, main = colnames(Thailand_tp[,18]), xlab = "total percipitation")
hist(Thailand_tp$"2022", breaks=15, main = colnames(Thailand_tp[,19]), xlab = "total percipitation")
```

## Question 4 (Niklas)

Check the temporal variation of Dengue cases/deaths.

```{r}
#load Dengue cases and death
cases = read_excel("Dengue_Data.xlsx", sheet = "Dengue_cases")
death = read_excel("Dengue_Data.xlsx", sheet = "Denge_deaths")


#clean data just for Thailand
cases_Thai = cases[,c(1,3)]
death_Thai = death[,c(1,3)]


#plot to see cases and death numbers over time
plot(cases_Thai, type = "b", pch = 19); plot(death_Thai, type = "b", pch = 19) 
```

The number of cases peak every 2-3 years, as well as the death count. It should be observed next if there is a correlation between the peaks and the climate data. Between 2015 and 2019 was a rather calm period with less outbreaks than before, which could also be correlated to climate data.
